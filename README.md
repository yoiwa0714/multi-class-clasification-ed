# ED学習アルゴリズムによるマルチクラス分類 v0.2.0

## 概要

本プロジェクトは、**金子勇氏**が1999年に開発された**Error Diffusion（ED）学習アルゴリズム**
に基づくマルチクラス分類システムの完全実装です。[`ed_genuine.prompt.md`](ed_genuine.prompt.md)の理論仕様に100%準拠し、
金子氏のC言語ソースコードパターン`pat[5]: One-Hot符号化(マルチクラス用)`を忠実に再現した
Python実装となっています。MNIST/Fashion-MNISTデータセットでの高精度マルチクラス分類を実現します。

## 主要特徴

### ✅ 理論準拠性
- **100% [ed_genuine.prompt.md](ed_genuine.prompt.md)準拠**: 金子氏の原理論の完全実装
- **統一誤差計算**: ED法 `abs(teacher-output)` による一貫した誤差処理
- **独立出力ニューロン構造**: 各出力ニューロンが独自の重み空間を維持

### 🚀 性能最適化
- **GPU高速化**: CuPy対応による大幅な学習速度向上
- **ミニバッチ学習**: 効率的なバッチ処理による高速化
- **メモリ効率**: 最適化されたデータ構造とメモリ管理

### 📊 豊富な可視化機能
- **リアルタイム学習進捗**: 誤差・精度の可視化
- **累積混同行列**: 学習開始からの性能推移
- **重み分布分析**: ネットワークの内部状態可視化(混同行列グラフ)
- **日本語フォント対応**: 完全な日本語表示サポート

## クイックスタート

### 1. 依存関係のインストール

```bash
# 基本環境（CPU）
pip install -r requirements.txt

# GPU高速化環境（推奨）
pip install cupy-cuda11x  # CUDA 11.x環境の場合
```

### 2. 基本実行

```bash
# 推奨設定での実行
python multi_ed_v020.py --epochs 10 --hidden 128 --batch 32

# 可視化付き実行
python multi_ed_v020.py --epochs 10 --viz --save_fig results

# Fashion-MNISTでの実行
python multi_ed_v020.py --fashion --epochs 10 --viz
```

### 3. 高度な使用例

```bash
# 詳細分析モード
python multi_ed_v020.py --viz --verbose

# CPU強制実行
python multi_ed_v020.py --cpu
```

## 背景理論

Error Diffusion学習アルゴリズムは、生物学的な神経伝達物質拡散メカニズムを模倣した革新的な
ニューラルネットワーク学習手法です。従来の誤差逆伝播法とは異なり、以下の特徴を持ちます：

### 核心原理
- **独立出力ニューロン構造**: 各出力ニューロンが独自の重み空間を維持
- **興奮性-抑制性ニューロンペア**: 生物学的にインスパイアされたペアニューロン構造
- **アミン拡散学習制御**: 神経伝達物質様の拡散による誤差伝播

### マルチクラス対応

金子氏の`pat[5]`実装では、各クラスが完全に独立したニューラルネットワークで処理される
革新的なアプローチを導入：

```c
// 各出力ニューロン（クラス）が独自の3次元重み配列を持つ
double w_ot_ot[NMAX+1][MAX+1][MAX+1];  // [出力ニューロン][出力先][入力元]
```

主要な利点：
- **並列クラス学習**: 各クラスが干渉なく独立して学習
- **スケーラブルなマルチクラス処理**: 新しいクラスの追加が容易
- **クラス間干渉の軽減**: クラス間の負の転移を最小化

## コマンドライン引数

### ED法アルゴリズムパラメータ
- `--learning_rate, --lr`: 学習率 alpha（デフォルト: 0.8）
- `--amine, --ami`: 初期アミン濃度 beta（デフォルト: 0.3）
- `--diffusion, --dif`: アミン拡散係数 u1（デフォルト: 1.0）
- `--sigmoid, --sig`: シグモイド閾値 u0（デフォルト: 0.4）
- `--weight1, --w1`: 重み初期値1（デフォルト: 1.0）
- `--weight2, --w2`: 重み初期値2（デフォルト: 1.0）

### 実行設定パラメータ
- `--epochs, --epo`: エポック数（デフォルト: 3）
- `--hidden, --hid`: 隠れ層ニューロン数（デフォルト: 128）
- `--batch_size, --batch`: ミニバッチサイズ（デフォルト: 32）
- `--train_samples, --train`: 訓練データ数（デフォルト: 100）
- `--test_samples, --test`: テストデータ数（デフォルト: 100）

### 動作モード
- `--viz`: リアルタイム可視化を有効化
- `--verbose, --v`: 詳細表示を有効化
- `--profile, --p`: 訓練時間詳細プロファイリング
- `--cpu`: CPU強制実行モード（GPU無効化）
- `--fashion`: Fashion-MNISTデータセット使用
- `--save_fig [DIR]`: 図表保存（引数なし: ./images、引数あり: 指定ディレクトリ）
- `--seed`: ランダムシード（デフォルト: ランダム）

## 技術仕様

### 対応環境
- **Python**: 3.8以上
- **GPU**: CUDA対応GPU（オプション）
- **OS**: Linux, Windows, macOS

### アーキテクチャ
```
modules/
├── ed_core.py          # 核となるED法実装（1,517行）
├── network_mnist.py    # MNIST専用ネットワーク構造（423行）
├── performance.py      # 性能評価・分析（684行）
├── visualization.py    # 可視化・グラフ生成（454行）
└── data_loader.py      # データローディング（64行）
```

## 実験結果と検証

### 理論準拠性検証
- ✅ [`ed_genuine.prompt.md`](ed_genuine.prompt.md)仕様との100%一致確認済み
- ✅ 金子氏原論文の数式との整合性検証完了
- ✅ 独立出力ニューロン構造の正確な実装確認

## 研究応用

本実装は以下の用途に適用可能：

- **従来の誤差逆伝播法との比較研究**
- **生物学的ニューラルネットワークモデリング**
- **マルチクラス分類アルゴリズムの**ベンチマーク
- **新規学習アルゴリズム**の開発基盤

## ファイル構成

```
multi_ed_v020.py          # メインプログラム（524行）
requirements.txt          # 依存関係管理（58行）
[ed_genuine.prompt.md](ed_genuine.prompt.md)      # 理論的背景（377行）
README.md                 # プロジェクト概要（本ファイル）
modules/                  # コアモジュール群（総計3,190行）
└── [各種実装モジュール]
```

## 依存関係

### 必須パッケージ
```
numpy>=1.21.0
matplotlib>=3.5.0
tqdm>=4.62.0
```

### 機械学習パッケージ
```
torch>=1.10.0
torchvision>=0.11.0
```

### オプション（GPU高速化）
```
cupy>=10.0.0  # CUDA対応GPU使用時
```

詳細なインストール手順は`requirements.txt`を参照してください。

## 引用

本実装を研究で使用される場合は、できるだけ以下を引用するようにしてください：

```
金子勇 (1999). Error Diffusion学習アルゴリズム - マルチクラス分類のためのOne-Hot符号化実装
[ED-Genuine Algorithm v0.2.0 Python実装]
```

## ライセンス

本プロジェクトは、金子氏のオリジナル研究のオープン精神を尊重し、MITライセンスの下で公開されています。

## 終わりに

Error Diffusion学習アルゴリズムの先駆的研究と、`pat[5]`マルチクラス実装により提供された
インスピレーションに対し、**金子勇氏**に敬意を表します。本プロジェクトは、金子氏の
生物学的にインスパイアされた機械学習への革新的アプローチを保存し、発展させることを目的と
しています。

---

**注意**: 本実装は[`ed_genuine.prompt.md`](ed_genuine.prompt.md)の詳細な理論仕様と金子氏のオリジナルCコードの
研究に基づいています。研究者の皆様には、完全な理論的理解のため、[`ed_genuine.prompt.md`](ed_genuine.prompt.md)と
オリジナルのソース資料も参照されることをお勧めします。
